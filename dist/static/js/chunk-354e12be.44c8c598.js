(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-354e12be"],{"1b47":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",staticClass:"ry_form",attrs:{model:e.queryParams,inline:!0,"label-width":"100px",size:"medium"}},[a("el-form-item",{attrs:{label:"创建时间"}},[a("el-date-picker",{staticStyle:{width:"240px"},attrs:{size:"small","value-format":"yyyy-MM-dd",type:"daterange",clearable:!0,"picker-options":e.pickerOptions,"range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),a("el-form-item",{attrs:{label:"处理状态"}},[a("el-select",{attrs:{clearable:"",size:"small"},model:{value:e.queryParams.status,callback:function(t){e.$set(e.queryParams,"status",t)},expression:"queryParams.status"}},[a("el-option",{attrs:{value:"0",label:"未处理"}}),a("el-option",{attrs:{value:"1",label:"已处理"}})],1)],1),a("el-form-item",{staticClass:"flex_one tr"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.feedbackList,border:""}},[a("el-table-column",{attrs:{label:"反馈人",align:"left",prop:"nickname",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",[e._v("用户ID："+e._s(t.row.createBy))]),a("p",[e._v(e._s(t.row.phone))])]}}])}),a("el-table-column",{attrs:{label:"反馈时间",prop:"createTime",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e.parseTime(t.row.createTime)))])]}}])}),a("el-table-column",{attrs:{label:"反馈类型",prop:"type"}}),a("el-table-column",{attrs:{label:"具体内容",prop:"content","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{label:"图片"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.imageList,(function(n){return t.row.imageList.length?a("el-image",{key:n,staticStyle:{width:"60px",height:"60px"},attrs:{src:n,"preview-src-list":[n]}}):e._e()}))}}])}),a("el-table-column",{attrs:{label:"处理状态/时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.handleStatus?a("div",[e._v("已处理")]):a("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},on:{change:function(a){return e.changeStatus(t.row)}},model:{value:t.row.handleStatus,callback:function(a){e.$set(t.row,"handleStatus",a)},expression:"scope.row.handleStatus"}}),a("div",[e._v(e._s(t.row.handleTime?e.parseTime(t.row.handleTime):""))])]}}])}),a("el-table-column",{attrs:{label:"备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{staticClass:"mr10"},[e._v(e._s(t.row.remark))]),a("i",{staticClass:"el-icon-edit pointer",on:{click:function(a){return e.showUpdateMark(t.row)}}})]}}])})],1),a("InBody",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}]},[a("pagination",{attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1),a("el-dialog",{attrs:{title:"修改备注",visible:e.remarkModal.visible,width:"30%","append-to-body":""},on:{"update:visible":function(t){return e.$set(e.remarkModal,"visible",t)}}},[a("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入内容"},model:{value:e.remarkModal.remark,callback:function(t){e.$set(e.remarkModal,"remark",t)},expression:"remarkModal.remark"}}),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.remarkModal.visible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.updateRemark}},[e._v("确 定")])],1)],1)],1)},r=[],i=a("5530"),s=a("c14f"),o=a("1da1"),l=(a("4de4"),a("d81d"),a("d3b7"),a("0643"),a("2382"),a("4e3e"),a("a573"),a("159b"),a("b775"));function u(e){return Object(l["a"])({url:"/ums/feedback/mark/update",method:"post",data:e})}function c(e){return Object(l["a"])({url:"/ums/feedback/handle/status/change",method:"post",data:e})}function d(e,t){return Object(l["a"])({url:"/ums/feedback/list",method:"post",data:e,params:t})}var m=a("93e7"),p=a("2f62"),f={name:"UmsMember",data:function(){return{show:!1,pickerOptions:{shortcuts:m["b"].getTimeShort()},remarkModal:{visible:!1,mark:null,memberId:null},loading:!0,exportLoading:!1,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,feedbackList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,status:null},dateRange:[],form:{}}},created:function(){var e=this;return Object(o["a"])(Object(s["a"])().m((function t(){return Object(s["a"])().w((function(t){while(1)switch(t.n){case 0:e.getList();case 1:return t.a(2)}}),t)})))()},computed:Object(i["a"])({},Object(p["b"])(["userId"])),methods:{showUpdateMark:function(e){this.remarkModal={visible:!0,remark:e.remark,id:e.id}},updateRemark:function(){var e=this;u({id:this.remarkModal.id,remark:this.remarkModal.remark}).then((function(t){if(t>0){e.$message.success("修改成功"),e.remarkModal.visible=!1;var a=e.feedbackList.filter((function(t){return t.id===e.remarkModal.id}))[0];console.log(111,a,e.remarkModal.remark),a.remark=e.remarkModal.remark}else e.$message.error("修改失败")}))},getList:function(){var e=this;this.loading=!0;var t=this.queryParams,a=t.pageNum,n=t.pageSize,r=Object(i["a"])(Object(i["a"])({},this.queryParams),{},{pageNum:void 0,pageSize:void 0}),s={page:a-1,size:n};(!this.dateRange||this.dateRange.length>0)&&(r=Object(i["a"])({},this.addDateRange2(r,this.dateRange))),d(r,s).then((function(t){var a=t.content,n=t.totalElements;a.forEach((function(e){e.images?e.imageList=e.images.split(","):e.imageList=[]})),e.feedbackList=a,e.total=n,e.loading=!1}))},cancel:function(){this.open=!1,this.reset()},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},handleSelectionChange:function(e){this.ids=e.map((function(e){return e.id})),this.single=1!==e.length,this.multiple=!e.length},changeStatus:function(e){var t=this,a={id:e.id,handleStatus:e.handleStatus};c(a).then((function(e){e&&(t.$message.success("操作成功"),t.getList())}))}}},g=f,h=a("2877"),v=Object(h["a"])(g,n,r,!1,null,null,null);t["default"]=v.exports},"93e7":function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("d3b7"),a("4d63"),a("c607"),a("ac1f"),a("2c3e"),a("00b4"),a("25f0"),a("5319");function n(e,t){if(!e||0===e)return"";if(!(e instanceof Date)&&(e=new Date(e),"Invalid Date"===e.toString()))return"无效时间戳";t=t||"yyyy-MM-dd hh:mm:ss";var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var n in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+n+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?a[n]:("00"+a[n]).substr((""+a[n]).length)));return t}function r(e){var t=new Date;t.setDate(t.getDate()+e);var a=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();return a+"-"+n+"-"+r}function i(e,t){if(!(e.type instanceof Date))return e;var a=new Date(e.getTime());return a.setDate(e.getDate()+t),a}function s(e,t){if(!(e.type instanceof Date))return e;var a=new Date(e.getTime()+60*t*60*1e3);return a}function o(e,t){var a=new Date;a.setMonth(a.getMonth()+t);var n=a.getFullYear(),r=a.getMonth()+1,i=a.getDate();return n+"-"+r+"-"+i}function l(e,t){return parseInt((t-e)/1e3/60/60/24)}function u(e,t){return parseInt((t-e)/1e3/60/60/24)+1}function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(null==e)return null;var t=new Date((new Date).setHours(0,0,0,0)).getTime();return new Date(t+864e5*e)}function d(e){var t=c(0),a=c(0);return a.setTime(a.getTime()-864e5*e),{end:t,start:a}}function m(){var e=[{text:"今天",onClick:function(e){var t=d(0),a=t.end,n=t.start;e.$emit("pick",[n,a])}},{text:"昨天",onClick:function(e){var t=c(0);t.setTime(t.getTime()-864e5),e.$emit("pick",[t,t])}},{text:"最近一周",onClick:function(e){var t=d(7),a=t.end,n=t.start;e.$emit("pick",[n,a])}},{text:"最近一个月",onClick:function(e){var t=d(30),a=t.end,n=t.start;e.$emit("pick",[n,a])}},{text:"最近三个月",onClick:function(e){var t=d(90),a=t.end,n=t.start;e.$emit("pick",[n,a])}}];return e}function p(){var e=[{text:"今天",onClick:function(e){var t=new Date;e.$emit("pick",[new Date(t.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,0))])}},{text:"昨天",onClick:function(e){var t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",[new Date(t.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,0))])}},{text:"前一周",onClick:function(e){var t=new Date,a=new Date;t.setTime(a.getTime()-5184e5),e.$emit("pick",[new Date(t.setHours(0,0,0,0)),new Date(a.setHours(23,59,59,0))])}},{text:"这个月",onClick:function(e){var t=r(),a=n();function n(){var e=new Date;return e.setDate(1),e}function r(){var e=new Date,t=e.getMonth(),a=++t,n=new Date(e.getFullYear(),a,1),r=864e5;return new Date(n-r)}e.$emit("pick",[new Date(a.setHours(0,0,0,0)),new Date(t.setHours(23,59,59,0))])}},{text:"前一个月",onClick:function(e){var t=new Date,a=new Date;t.setTime(a.getTime()-25056e5),e.$emit("pick",[new Date(t.setHours(0,0,0,0)),new Date(a.setHours(23,59,59,0))])}}];return e}t["b"]={getAfterDate:r,getAfterMounth:o,dateDiff:l,dateDiffIncludeToday:u,getAfterDateReturnDate:i,getAfterHourReturnDate:s,getTimeShort:m,getTimeShort2:p,dateFormat:n,getStartEnd:d,getMorningTime:c}}}]);